<div id="stage">
  <canvas id="grid" height="<%= @grid.height %>", width="<%= @grid.width %>" data-pixel-bits="<%= @grid.pixel_bits %>", data-id="<%= @grid.id %>"></canvas>
</div>

<!-- <button id="reset-zoom" class="btn btn-primary" onclick="stage.style.transform = 'matrix(0.85, 0, 0, 0.85, 525, 15)'">Reset View</button> -->
<div class="cols-container">
  <div id="white"></div>
  <div id="dkgrey"></div>
  <div id="red"></div>
  <div id="blue"></div>
  <div id="green"></div>
  <div id="brown"></div>
  <div id="purple"></div>
  <div id="ltgrey"></div>
  <div id="ltgreen"></div>
  <div id="ltblue"></div>
  <div id="cyan"></div>
  <div id="orange"></div>
  <div id="yellow"></div>
  <div id="tan"></div>
  <div id="pink"></div>
  <div id="black"></div>
</div>

<% content_for :after_js do %>
  <script>
    console.log("Pre app");
    App['grid_<%= @grid.id %>'] = App.cable.subscriptions.create(
      { channel: 'GridsChannel', grid_id: <%= @grid.id %> },
      { received: (placement) => {
        console.log("I ran!");
        if (placement.current_user_id !== <%= current_user.id %>) {
          console.log("I ran!");
          let canvas = document.getElementById('grid');
          let ctx = canvas.getContext('2d');

          ctx.fillStyle = placement.color;
          ctx.fillRect(placement.x, placement.y, 1, 1);
        }
      }
    }
    );
  </script>
<% end %>
